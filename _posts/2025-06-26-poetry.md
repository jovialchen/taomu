---
title: "Poetry"
layout: post
date: 2025-06-26
categories: tech_coding
tags:
    - python
---



ä¸‹é¢æ˜¯å¯¹ Python ä¸­ Poetry çš„å…¨é¢ä»‹ç»ï¼ŒåŒ…æ‹¬æ ¸å¿ƒæ–‡ä»¶åŠå…¶å†…å®¹ç¤ºä¾‹ï¼š

---

## ğŸ›  Poetry æ˜¯ä»€ä¹ˆï¼Ÿ

* **Poetry** æ˜¯ä¸€ä¸ªç°ä»£åŒ–çš„ Python ä¾èµ–ç®¡ç†å’Œæ‰“åŒ…å·¥å…·ã€‚å®ƒæ•´åˆäº†ç±»ä¼¼ pipã€virtualenvã€setuptools çš„åŠŸèƒ½ï¼Œæä¾›å£°æ˜ä¾èµ–ã€è‡ªåŠ¨åˆ›å»ºè™šæ‹Ÿç¯å¢ƒã€ç”Ÿæˆ lockfileã€æ‰“åŒ…å‘å¸ƒç­‰ä¸€ç«™å¼ä½“éªŒ([python-poetry.org][1])ã€‚
* Poetry ä½¿ç”¨ `pyproject.toml` æ¥ç»Ÿä¸€é…ç½®ï¼Œæ— éœ€ `requirements.txt` æˆ– `setup.py`ï¼Œä¾èµ–è§£ææ›´ç®€å•ï¼Œå®‰è£…å¯é‡å¤æ€§å¼ºã€‚

---

## æ ¸å¿ƒæ–‡ä»¶ç»“æ„ä¸å†…å®¹

```text
my_project/
â”œâ”€â”€ pyproject.toml
â”œâ”€â”€ poetry.lock
â””â”€â”€ my_project/
    â””â”€â”€ __init__.py
```

### 1. `pyproject.toml`

æ ¸å¿ƒé…ç½®æ–‡ä»¶ï¼ŒTOML æ ¼å¼ï¼ŒåŒ…å«é¡¹ç›®å…ƒæ•°æ®ã€ä¾èµ–ã€æ„å»ºé…ç½®ç­‰ã€‚ç¤ºä¾‹ç»“æ„ï¼š

```toml
[tool.poetry]
name = "my_project"
version = "0.1.0"
description = "A simple project."
authors = ["Your Name <you@example.com>"]

[tool.poetry.dependencies]
python = "^3.9"
requests = "^2.25.1"

[tool.poetry.dev-dependencies]
pytest = "^6.2.2"

[build-system]
requires = ["poetry-core>=1.0.0"]
build-backend = "poetry.core.masonry.api"
```

* `[tool.poetry]`ï¼šé¡¹ç›®åç§°ã€ç‰ˆæœ¬ã€æè¿°ã€ä½œè€…ç­‰([aicodesnippet.com][2])
* `[tool.poetry.dependencies]`ï¼šè¿è¡Œæ—¶ä¾èµ–ï¼Œä¾‹å¦‚ `python = "^3.9"`ã€`requests`
* `[tool.poetry.dev-dependencies]`ï¼šå¼€å‘ä¾èµ–ï¼Œå¦‚ `pytest`ï¼Œä»…ç”¨äºæµ‹è¯•ã€lint ç­‰([geeksforgeeks.org][3])
* `[build-system]`ï¼šæŒ‡å®šæ„å»ºåç«¯å’Œè¿è¡Œæ—¶ä¾èµ–ï¼Œæ˜¯ PEP 517 å¿…éœ€([aicodesnippet.com][2])

### 2. `poetry.lock`

* è‡ªåŠ¨ç”Ÿæˆï¼Œè®°å½•æ‰€æœ‰ä¾èµ–åŠå…¶ç²¾ç¡®ç‰ˆæœ¬ï¼Œç¡®ä¿å®‰è£…ç»“æœä¸€è‡´ï¼Œé€‚åˆ CI/CD ç¯å¢ƒ
* åŒ…å«æ¯ä¸ªä¾èµ–åŒ…çš„ nameã€versionã€ç±»åˆ«ï¼ˆmain/devï¼‰ã€Python å…¼å®¹æ€§ç­‰ä¿¡æ¯

---

## å¸¸ç”¨æ“ä½œå‘½ä»¤

ä»¥ä¸‹æ“ä½œé€šè¿‡ Poetry CLI å®Œæˆï¼š

| æ“ä½œ     | å‘½ä»¤                                      | è¯´æ˜                                                                                          |
| ------ | --------------------------------------- | ------------------------------------------------------------------------------------------- |
| åˆå§‹åŒ–é¡¹ç›®  | `poetry new my_project` / `poetry init` | åˆ›å»ºé¡¹ç›®ç›®å½•å’Œåˆå§‹ `pyproject.toml`([geeksforgeeks.org][3], [python.land][4], [pythoncentral.io][5]) |
| å®‰è£…ä¾èµ–   | `poetry install`                        | åˆ›å»ºè™šæ‹Ÿç¯å¢ƒå¹¶å®‰è£…æ‰€æœ‰ä¾èµ–ï¼ˆå« lock ä¸­ç‰ˆæœ¬ï¼‰                                                                   |
| æ·»åŠ è¿è¡Œä¾èµ– | `poetry add <package>`                  | æ·»åŠ ä¾èµ–å¹¶æ›´æ–° pyproject.toml + poetry.lock                                                        |
| æ·»åŠ å¼€å‘ä¾èµ– | `poetry add --dev <package>`            | æ·»åŠ åˆ° dev-dependencies                                                                        |
| å‡çº§ä¾èµ–   | `poetry update`                         | æ£€æŸ¥ç¬¦åˆè¯­ä¹‰è§„åˆ™çš„æœ€æ–°ç‰ˆæœ¬å¹¶æ›´æ–° lockfile                                                                   |
| ç§»é™¤ä¾èµ–   | `poetry remove <package>`               | ä»é¡¹ç›®ä¸­ç§»é™¤åŒ…ï¼Œä¹Ÿæ›´æ–° lockfile                                                                        |
| æŸ¥çœ‹ä¾èµ–æ ‘  | `poetry show --tree`                    | å±•ç¤ºä¾èµ–åŠå…¶å­ä¾èµ–ç»“æ„                                                                                 |
| è¿è¡Œè„šæœ¬   | `poetry run python script.py`           | åœ¨é¡¹ç›®è™šæ‹Ÿç¯å¢ƒä¸­è¿è¡Œè„šæœ¬                                                                                |
| æ„å»ºå‘å¸ƒ   | `poetry build` / `poetry publish`       | ç”Ÿæˆ wheel/sdist å¹¶ä¸Šä¼ åˆ° PyPI æˆ–ç§æœ‰ä»“åº“                                                              |

---

## ç¤ºä¾‹å·¥ä½œæµç¨‹

```bash
# å®‰è£… poetryï¼ˆæ¨èå®˜æ–¹è„šæœ¬ï¼‰
curl -sSL https://install.python-poetry.org | python3 -

# åˆå§‹åŒ–æˆ–åˆ›å»ºé¡¹ç›®
poetry new demo
cd demo

# æ·»åŠ ä¾èµ–
poetry add requests
poetry add --dev pytest

# å®‰è£…ç¯å¢ƒ
poetry install

# æŸ¥çœ‹ä¾èµ–æ ‘
poetry show --tree

# è¿è¡Œè„šæœ¬æˆ–æµ‹è¯•
poetry run python demo/__init__.py
poetry run pytest

# å‘å¸ƒé¡¹ç›®
poetry build
poetry publish
```

---

## ä¸ºä»€ä¹ˆä½¿ç”¨ Poetryï¼Ÿ

1. **ç»Ÿä¸€ç®¡ç†**ï¼šä¸€ä¸ªå·¥å…·æå®šä¾èµ–ã€è™šæ‹Ÿç¯å¢ƒã€æ‰“åŒ…ã€å‘å¸ƒ([toraritte.github.io][6], [python-poetry.org][1], [geeksforgeeks.org][3], [dnmtechs.com][7], [python.land][4])
2. **å¯é‡å¤å®‰è£…**ï¼šä¸¥æ ¼ lockfileï¼Œå®ç°ç¯å¢ƒä¸€è‡´æ€§([python.land][4])
3. **ç®€åŒ–æµç¨‹**ï¼šä¾èµ–è§£æã€è™šæ‹Ÿç¯å¢ƒã€å‘å¸ƒå…¨è‡ªåŠ¨åŒ–

---

## æ€»ç»“

* `pyproject.toml` æ˜¯æ ¸å¿ƒï¼Œå£°æ˜é¡¹ç›®é…ç½®ä¸ä¾èµ–ï¼›
* `poetry.lock` é”å®šç¡®åˆ‡ç‰ˆæœ¬ï¼Œç¡®ä¿ç¯å¢ƒä¸€è‡´ï¼›
* å‘½ä»¤è¡Œå¯ä»¥è½»æ¾æ‰§è¡Œ initializeã€installã€addã€runã€buildã€publish ç­‰ä¸€ç³»åˆ—æ“ä½œï¼›
* Poetry æ•´åˆå¤šä¸ªä¼ ç»Ÿå·¥å…·åŠŸèƒ½ï¼Œè®© Python é¡¹ç›®æ›´æ ‡å‡†ã€æ›´å¯é ã€æ›´æ˜“ç®¡ç†ã€‚

å¦‚æœä½ æƒ³æ·±å…¥æŸä¸€æ–¹é¢ï¼Œæ¯”å¦‚é«˜çº§é…ç½®ã€æ’ä»¶ã€CI é›†æˆç­‰ï¼Œå¯ä»¥ç»§ç»­æ¢ç´¢å®˜æ–¹æ–‡æ¡£å’Œç¤¾åŒºæ•™ç¨‹ã€‚æ¬¢è¿éšæ—¶ç»§ç»­è®¨è®ºå…·ä½“ç”¨æ³•ï¼

[1]: https://python-poetry.org/docs/?utm_source=chatgpt.com "Introduction | Documentation | Poetry - Python dependency management ..."
[2]: https://www.aicodesnippet.com/python/deployment-and-distribution/creating-a-pyprojecttoml-file-for-packaging-with-poetry.html?utm_source=chatgpt.com "Python : Creating a `pyproject.toml` file for packaging with Poetry"
[3]: https://www.geeksforgeeks.org/python/managing-dependencies-with-python-poetry/?utm_source=chatgpt.com "Managing dependencies with Python Poetry - GeeksforGeeks"
[4]: https://python.land/virtual-environments/python-poetry?utm_source=chatgpt.com "Python Poetry: Package and venv Management Made Easy"
[5]: https://www.pythoncentral.io/python-poetry-python-dependency-management/?utm_source=chatgpt.com "Python Poetry: Python Dependency Management - Python Central"
[6]: https://toraritte.github.io/poetry-intro/?utm_source=chatgpt.com "Introduction to the [Poetry] tool for Python projects"
[7]: https://dnmtechs.com/running-a-script-with-pyproject-toml-settings-and-poetry/?utm_source=chatgpt.com "Running a Script with pyproject.toml Settings and Poetry"


